Лабораторна робота №7
Комплексна система двоетапного захисту з аналітичним модулем

Дисципліна: Кібербезпека / Захист інформації
Автор: Mykhailo Dominov

Мета роботи — створити комплексну систему захисту інформації, що поєднує два методи з попередніх лабораторних робіт, автоматично застосовує їх послідовно до одного файлу, забезпечує повне відновлення оригінальних даних та містить аналітичний модуль для оцінки ефективності реалізованого підходу.

У межах роботи реалізовано програму «Двоетапний захист з аналітикою», яка забезпечує багаторівневий захист файлу. У якості тестового об’єкта використано файл CV_Mykhailo_Dominov.pdf.

Система складається з двох послідовних етапів. Перший етап — симетричне шифрування файлу. Для цього використано бібліотеку cryptography та алгоритм Fernet. Ключ формується на основі персонального рядка користувача. Спочатку обчислюється SHA-256 хеш від введених даних, що створює 32-байтове значення. Далі цей хеш кодується у формат URL-safe Base64 відповідно до вимог Fernet. Отриманий ключ застосовується для шифрування вхідного файлу. Такий підхід забезпечує конфіденційність інформації, захист від несанкціонованого доступу та криптографічну цілісність завдяки використанню механізму HMAC.

Другий етап — стеганографічне приховування зашифрованих даних у зображенні методом LSB (Least Significant Bit). Зашифровані байти вбудовуються у найменш значущі біти кожного каналу RGB зображення-контейнера. Один піксель дозволяє зберігати 3 біти інформації (по одному біту на кожен канал R, G та B). Перед прихованими даними додається службовий заголовок, який містить маркер формату, довжину payload та SHA-256 хеш ciphertext для контролю цілісності. У результаті формується файл protected.png, який зовні виглядає як звичайне зображення, але містить приховані зашифровані дані.

Місткість зображення-контейнера визначається формулою:
capacity_bytes ≈ (width × height × 3) / 8 − службові_дані,
де width × height — кількість пікселів, 3 — кількість бітів, що зберігаються у кожному пікселі, 8 — кількість бітів у байті. Для зображення 1920×1080 теоретична місткість становить приблизно 777 600 байт, що достатньо для розміщення зашифрованого PDF-файлу обсягом близько 379 000 байт.

Програма автоматично збирає аналітичні метрики: тривалість шифрування, тривалість LSB-вбудовування, тривалість вилучення, тривалість дешифрування, розміри файлів до та після кожного етапу, відсоткову зміну розміру та контрольні SHA-256 хеші. Звіти зберігаються у форматах JSON та TXT у папках results/protect та results/restore.

Система демонструє необхідність обох етапів захисту. Без вилучення LSB-даних отримати зашифрований вміст неможливо. Без правильного ключа дешифрування завершується помилкою InvalidToken. Після повного циклу «захист → відновлення» контрольні SHA-256 хеші оригінального та відновленого файлів співпадають, що підтверджує повну цілісність даних.

Під час тестування стійкості було виконано спробу розшифрування з неправильним ключем, яка завершилася невдачею. Також перевірено контрольні суми даних після відновлення — вони повністю співпадають з початковими. Збільшення розміру файлу після шифрування є очікуваним і пояснюється додаванням службових структур Fernet (IV, HMAC та службові поля).

Реалізована система може використовуватися для захисту персональних документів, передачі конфіденційних файлів електронною поштою, зберігання даних на зовнішніх носіях та демонстрації принципів багаторівневої інформаційної безпеки.

У результаті виконання лабораторної роботи створено комплексну систему захисту, що поєднує симетричне шифрування та стеганографію, автоматизує процес захисту та відновлення файлів і забезпечує аналітичну оцінку ефективності. Отримані результати підтверджують, що комбінування криптографічних методів і приховування даних суттєво підвищує рівень захисту інформації порівняно з використанням лише одного методу.